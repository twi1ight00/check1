using System;
using System.Security.Cryptography;

namespace Enyim;

/// <summary>
/// Implements the Tiger hash. (http://www.cs.technion.ac.il/~biham/Reports/Tiger/)
///
/// Ported (and cleaned&amp;sped up) from the Tiger.NET VB code. (http://www.hotpixel.net/software.html)
/// </summary>
public sealed class TigerHash : HashAlgorithm
{
	private const int PASSES = 3;

	private const int BLOCKSIZE = 64;

	private long totalLength;

	private ulong a;

	private ulong b;

	private ulong c;

	private byte[] internalDataBuffer;

	private int bufferPosition;

	private ulong[] block = new ulong[8];

	private static readonly ulong[] T = new ulong[1024]
	{
		192161084409973854uL, 12412566003039578348uL, 8272369121297300691uL, 7854730284916899642uL, 14815005489349235091uL, 8463286011307239906uL, 12782397079979459523uL, 5082381371487377520uL, 16910140313379794150uL, 14213758138097816412uL,
		5541490850629862524uL, 766444128913191948uL, 1204553577021685498uL, 14325024777722506090uL, 1401289229890216703uL, 1893918052108309022uL, 5461170853188208586uL, 2807403890869420487uL, 9624326389127268278uL, 5699452412975025298uL,
		15532482038911174219uL, 10247451172578640253uL, 7624427211800470465uL, 13116673706182362478uL, 9043806901924967914uL, 7231827479902542914uL, 13778939497803891424uL, 6875646691050945796uL, 17492696646193712838uL, 7786398710221814956uL,
		8167597339425066981uL, 1830707105885056415uL, 18253814936157636059uL, 14445834393465872395uL, 9656360342964607310uL, 11887624205054558387uL, 10399800464770430483uL, 15811522062611479537uL, 1783120314242633559uL, 248005612187258982uL,
		7688500634458409525uL, 17647688304275301531uL, 8591138587399736033uL, 15633037317611203077uL, 13643301300320350067uL, 5042603696143252264uL, 2053990370701680515uL, 10011753445593162089uL, 3741955435321465241uL, 4334407786093429776uL,
		13046945900594209529uL, 1449859124008718907uL, 18187146081364455764uL, 16146959651762660871uL, 9821796187408409551uL, 10596140432474060285uL, 3847074041673952000uL, 4649400157396704725uL, 14173244547020241484uL, 14606001508420839982uL,
		2909491499011162061uL, 4458122598401901638uL, 7071481730398905774uL, 6725294491764459774uL, 12245192337599078954uL, 14074214025701625255uL, 1226483701329067140uL, 15924709066658687059uL, 14770628265263427446uL, 13470993037325816321uL,
		16615015929427450229uL, 10714085159597194772uL, 479582384021555544uL, 8040612334407127321uL, 15648517004018321088uL, 17112515522038886866uL, 8751740296797632830uL, 6603430683508552489uL, 8942924799792477540uL, 3573742753214737511uL,
		16027224499883949314uL, 6349030933445924429uL, 15944798094267651441uL, 12269290567006146658uL, 10560886376429385824uL, 5194369709296555225uL, 7174555471952375656uL, 7982812746821821468uL, 9739074967177125163uL, 3232013613859041307uL,
		12699367828500449645uL, 16215284685696605295uL, 3112410413624570453uL, 16110141331589860284uL, 6658792778814911418uL, 6126246269502162262uL, 12375791606097406863uL, 4721051187472420532uL, 12913124649239600434uL, 13593718485625264257uL,
		2663576151211431276uL, 928112258657309258uL, 5664920977038299994uL, 2704699625848084345uL, 2312925355491498803uL, 17917931256736142540uL, 2964761606854114992uL, 4148718494125202372uL, 4082542483235864459uL, 5171535286737311423uL,
		2166137813939512309uL, 8844224567096109974uL, 12073497029628754377uL, 10313129584137200909uL, 7053919794999990929uL, 5576291611870337032uL, 17071918333241912043uL, 17712290504455390414uL, 17740771901396443681uL, 11758017946897781732uL,
		10978122417803504804uL, 14919163634504077233uL, 11490461953836997027uL, 12165654920579776535uL, 853355433004222246uL, 16522522127453838137uL, 2124075034376372323uL, 5881355904936746717uL, 1033318428544969251uL, 1692585388818821524uL,
		17200759021255085090uL, 1107424405919510210uL, 9235073569857586017uL, 12471487353192899638uL, 963191604767572015uL, 4506934758573727688uL, 11934771386322515838uL, 11732209241253279301uL, 7421261837586505858uL, 3318186242040429129uL,
		14044682965315173317uL, 1910808081503uL, 4771413979138012118uL, 15088778931977875125uL, 11635083951108444120uL, 3247421105326436348uL, 17436899165275233567uL, 8353265116968520410uL, 12565337778774156881uL, 10871874290690996106uL,
		6528592316425799439uL, 15397071475010590000uL, 15142762107613549607uL, 7320455443630736945uL, 11094769083352733519uL, 2539802313181221187uL, 11139220281097600151uL, 6084456898448652712uL, 1615327116689102472uL, 8126548348642832045uL,
		17352529224806255890uL, 6320848846662414801uL, 17282944389244390251uL, 3439926484095136410uL, 11228441527149633512uL, 4583261464596863494uL, 5278432013075676693uL, 672210957064462075uL, 13025854346008288483uL, 14498696732057183809uL,
		3753742208681096767uL, 13261228611926580032uL, 17986491732842022258uL, 111470777923844445uL, 1951374535466601971uL, 9571400392277455661uL, 13953014824866208278uL, 4830799035278983864uL, 13222015508416504078uL, 6842302225500364445uL,
		11335550205397804100uL, 15716824796288558584uL, 12864465832706149959uL, 18320322304522000518uL, 14411022707054136303uL, 16460574793555246339uL, 3977519900599801820uL, 9148781857317432677uL, 6468933130968205401uL, 8516219711084257782uL,
		1539015908620793624uL, 7527026033758878374uL, 16798794393021101279uL, 3088835283432281588uL, 3651919061693825289uL, 9461488011709396048uL, 18023579054726214285uL, 11414687284771824631uL, 308165109378616703uL, 8884692927086426203uL,
		2438838841395254149uL, 14896570625953598117uL, 2823241734971430590uL, 3896218688877146334uL, 393786506094771122uL, 15328770503170608105uL, 10473175056012527227uL, 10077980508395331620uL, 6934559736714979565uL, 17857395910652154129uL,
		10891890112678993536uL, 11568068034921390039uL, 14648678256067979723uL, 9344782632198616737uL, 13887300970038794941uL, 10781369878360680786uL, 10110669637513019833uL, 4236391428300945648uL, 555138268555536248uL, 5351590591369890935uL,
		4306521946498657944uL, 11295261863032656012uL, 4901816398460471456uL, 9412954593909222793uL, 7485939926152528684uL, 13340749930154375154uL, 6245128712556390173uL, 13728064239465473455uL, 18121470962401429929uL, 7772052866533484500uL,
		639373189613950878uL, 2515940555210603828uL, 16388058205984530442uL, 9187445612742136046uL, 12674756240461064247uL, 16320932256496599612uL, 15242008505997455568uL, 15052846203706837274uL, 1313621308117380133uL, 3526835097255131285uL,
		13493710469666597351uL, 8704164972314360376uL, 17526606163846348700uL, 5969067443919232116uL, 5791404459833380522uL, 16764031247701565831uL, 6001456072058810555uL, 10172882867408301456uL, 2241175407069758350uL, 15484192582789326408uL,
		8359644330926224055uL, 9923258301097833899uL, 18441560808156168866uL, 16657473437411103805uL, 11975088000835799072uL, 16988008119788939130uL, 16620180768708174136uL, 13087780087216503960uL, 6213947727727520144uL, 5496303794639560149uL,
		15650762814559589428uL, 642450021946863605uL, 15520994653159001329uL, 14194067837486075289uL, 16073846824652113554uL, 15991021072757504790uL, 8011611286970690052uL, 5372247966639775667uL, 11956475335693613649uL, 18180761396468528926uL,
		16734845874302321705uL, 15893194850365545698uL, 14791316918028724237uL, 1788379855404599063uL, 3792259505844355329uL, 857793142685420274uL, 2176386753693503798uL, 16165556464122449145uL, 18433866172389203220uL, 6070247714570225101uL,
		7358743242340641331uL, 9743228014385134454uL, 1522910625901990663uL, 16311896314355823354uL, 5235630359010597374uL, 12672095911739354858uL, 277273466943670671uL, 3580831169916433691uL, 17414337388161447897uL, 4657750985732713388uL,
		1177149711660596421uL, 8685721698255572101uL, 15219111713807365290uL, 12097333842433196187uL, 13637243492043779536uL, 10523434303980543600uL, 11720003357325288028uL, 13858952002212630691uL, 17788473056595710763uL, 3834592178494549117uL,
		14592892671379561684uL, 9581455899396743388uL, 8774750272303345432uL, 10018717713484244012uL, 15042560872303683366uL, 6519077675840655372uL, 1009372798613472243uL, 13941815458558040098uL, 7670504156571609794uL, 9378295951984427608uL,
		7481699948221361317uL, 2131352009749933493uL, 7854556580946198495uL, 5848046147829288198uL, 6811751916476253359uL, 17810787299410161198uL, 13709208837769715866uL, 16831935031467898469uL, 8245611441321613668uL, 8087057586628171618uL,
		5058061449640751271uL, 13294825889344038590uL, 7212395796113148780uL, 8872633840395976086uL, 8602726521519041395uL, 12561253256920036340uL, 6042660761688602872uL, 1642367900117110883uL, 25924001596622557uL, 7531865058110106323uL,
		4223621278438660202uL, 3926684511422013614uL, 16382380113756205527uL, 5939130201053773422uL, 8312208923375399755uL, 5278156969609628584uL, 12734421984402844485uL, 3610014133393185213uL, 9596519943885996947uL, 10457528947283767525uL,
		7953444341930717599uL, 13374154748713552676uL, 14768757517560628423uL, 5127306049615917691uL, 9121210965518562125uL, 8462056263389103903uL, 17703039091829532745uL, 5658738406708581754uL, 3084862250275496789uL, 15607266543450182998uL,
		14480359564937826262uL, 14959210002597418810uL, 18322749590590308156uL, 17101137515031609645uL, 9446964496815386772uL, 14254958291267920036uL, 1116769798908306816uL, 1871732813531574911uL, 12807515078363457603uL, 2050857069623328786uL,
		942713319182180155uL, 9890976159808040074uL, 16508030273321291366uL, 7028952989422544417uL, 9018945159409650955uL, 9348172371089358427uL, 512456053301416255uL, 14393200364208532887uL, 14115843866838292311uL, 16933948646436594152uL,
		15343759105510392346uL, 11057037641413621675uL, 11808547772908125699uL, 11334024907024538672uL, 4569666897377300404uL, 11295294635916036800uL, 4462677101358564049uL, 3679240545963649394uL, 14317631520548985665uL, 776201060342576796uL,
		17243909456190059557uL, 17604610864827148760uL, 10001446825249529526uL, 3458390008116962295uL, 10339343346676942200uL, 6618311662604863029uL, 4790267690900900096uL, 1716087693007726108uL, 4148457837926911568uL, 13027786587857474755uL,
		8968309666649857421uL, 15835383998547979361uL, 6968029403465067289uL, 14862556481213186354uL, 500987773930853904uL, 10278571274613639408uL, 2355660670689429871uL, 3178293543037890097uL, 12863151040160441096uL, 12149618985794982607uL,
		894835714693979080uL, 13140917299619429091uL, 18098692892679743463uL, 352461093517089771uL, 5441805419015688358uL, 15397362850185904124uL, 3501129463520285556uL, 13466617900358153333uL, 10143225092775386885uL, 11000396338623494503uL,
		2615208954064994172uL, 17924140821443864558uL, 2237558221535645089uL, 14534824473151846839uL, 13236032612028143522uL, 7102368496127332321uL, 10727377356684633597uL, 399232473491847935uL, 7140013836546489399uL, 10212002790465040192uL,
		16215351210583878990uL, 11386546581606838557uL, 5038446221635409553uL, 6294769326316815049uL, 18058941983678306709uL, 15096697943663711592uL, 15779936050728011823uL, 12285020473469085899uL, 2783168786742146440uL, 1986639352536355296uL,
		16458016955501249014uL, 8799325730492140254uL, 7305467695957075406uL, 2551364576700533681uL, 12365742766643545018uL, 13556939551025923470uL, 11121884478320942796uL, 11560995779659109437uL, 5760535140236403614uL, 1501217875009212803uL,
		17155111980276651522uL, 10740590121652346377uL, 6454505253869455699uL, 4319683495060363885uL, 12201821765133472647uL, 11627976249930647428uL, 2960027307368769952uL, 8570410701452901115uL, 160427886842421800uL, 13476805212888794763uL,
		13819301442714769089uL, 15161096039636807203uL, 10840625911376688560uL, 6176075057452006273uL, 7582622308322968760uL, 6649763778434249567uL, 18263287368680645066uL, 2699628156079216836uL, 16679512126457685165uL, 2945653313023238585uL,
		2813841150172635667uL, 8163160757531991904uL, 11234321609599741815uL, 12522125344893058495uL, 649720531103423106uL, 6394120152722619742uL, 17511778262592440498uL, 4753049982369101610uL, 2408845162401379802uL, 1253140645631747605uL,
		10647695429742646567uL, 16862477982545442873uL, 17990741204064412777uL, 8367255505928917714uL, 91400768704631494uL, 13982368817729209682uL, 1938401838693046941uL, 10926450282100227564uL, 9810146466437985312uL, 3990523136699180870uL,
		7731749711829208666uL, 4875740361372990282uL, 9173201802070489451uL, 7834799413446679311uL, 12013351936531834174uL, 3325271250982575439uL, 9716135266257811596uL, 16057385208373506132uL, 9237091451614363741uL, 4359958813756723849uL,
		4539467735137059035uL, 12938212395927242823uL, 1312945880979454078uL, 17499315598292792898uL, 4958176066159770025uL, 1374196081931091686uL, 11528309388770592584uL, 17351559514427848379uL, 17035274631238963172uL, 3145683508650593868uL,
		12407221208356893421uL, 14642276899857517585uL, 11883033819604736188uL, 6868326517302426863uL, 6758043032196830276uL, 5827167051130463242uL, 4074828688890126937uL, 3293442170241026694uL, 10380983089625111273uL, 5618223731912049521uL,
		15432198388343861625uL, 2520538699101199374uL, 17627031972844598171uL, 5224129141031473793uL, 16763249281696835647uL, 3214246200928423523uL, 15726560327778417602uL, 3432136347919366758uL, 11602366076889764820uL, 13748905236245012081uL,
		14966620937599181975uL, 13189541385867841559uL, 15286072487566162144uL, 10303139529070577017uL, 10864531730823556037uL, 7399204607179264370uL, 2410740665327626235uL, 12915425045000683329uL, 17314732200908842661uL, 10202635360025484021uL,
		10346713243535852126uL, 17581701249550998855uL, 17040480865221710045uL, 17702999974772413585uL, 11191718324395673746uL, 5293216666010209768uL, 11760393922366610529uL, 505172698323928814uL, 9942580208356683160uL, 12407545700111804674uL,
		2102395425312436973uL, 16966062287010644749uL, 6364975572501938982uL, 11411085932076284862uL, 10424236436870678051uL, 13966310405599776871uL, 2328871106231838244uL, 1378680973804076623uL, 14859971753385412708uL, 15691716086439804087uL,
		7519553577929664460uL, 460638964809724379uL, 18346923196617292268uL, 6562793443469826132uL, 1580997072160885165uL, 859005579845670993uL, 15387787899692562424uL, 15066929237798940388uL, 14509772897067631359uL, 9722885996444150946uL,
		3784640730692549981uL, 15931797558562408746uL, 17728532885004413945uL, 5877026246039211124uL, 9823170296600362018uL, 12063115411652128397uL, 4036482174343220762uL, 11995118481713087914uL, 12472271790989499929uL, 14327130824154426887uL,
		14241938299045681464uL, 1637614953354483776uL, 1768420517056302872uL, 12383262458672579103uL, 4469119677486524438uL, 6862084742702193339uL, 2666591392741323510uL, 1958911907595193257uL, 2078226524874004819uL, 9182514826368667184uL,
		12779288295799455805uL, 11485631769479599801uL, 7984583406477441100uL, 5152724216922222472uL, 16434817050700023809uL, 18234510019709827509uL, 4838452819165657451uL, 10009107659229344338uL, 14082648967264690522uL, 9603180932220791817uL,
		17494196096204240005uL, 7192165871822020282uL, 9489155661644977250uL, 4293149567017494192uL, 6266031685674981260uL, 3297360663327026118uL, 11022523844556058157uL, 1848411117523063487uL, 4803542876947788811uL, 11932736566254486873uL,
		3918859449562378630uL, 7730455268829558643uL, 2300310138214025757uL, 5073098731442674389uL, 16579416859534749813uL, 13327030148229826424uL, 2481833961960165662uL, 3483465760582650171uL, 14647584793672228655uL, 15832567204901745934uL,
		3683901813415452623uL, 11860503814910655190uL, 12166547435894244330uL, 11567973332241571036uL, 9797215346402413073uL, 1263269478536931145uL, 11026752283992642452uL, 12676928707863290380uL, 7280608515770959015uL, 7790930297845911262uL,
		13387369097968848820uL, 11741684142390913187uL, 8900403996915095151uL, 8816891275549542045uL, 17970260734629539600uL, 17214461913506212373uL, 3119849171172694992uL, 7662494604586420558uL, 149203013753700084uL, 5530308158539891708uL,
		4143436129840869576uL, 15035120613856864378uL, 17420391663083337065uL, 10122251552433275289uL, 6707891355510602429uL, 5715986277202524800uL, 18053537085616071129uL, 4600951196636466039uL, 13853232418390755104uL, 9065747437067558111uL,
		9545093663071697752uL, 2592076422926394627uL, 228032410479194937uL, 6667480117540136779uL, 588648581915253038uL, 16109793598716311100uL, 3634608293302267354uL, 1202024298738736502uL, 6299068367672194603uL, 1932346445954743183uL,
		7573861666572117031uL, 18384928506924659011uL, 3549459440654955014uL, 8158286332358861718uL, 10776371282861455089uL, 17930787456663004470uL, 14483524995628130770uL, 8464707252757847009uL, 397230465775035974uL, 13489606539521972333uL,
		675316509725923312uL, 2628613740627889320uL, 15914532455247542225uL, 5345232712238813773uL, 13670086066823634667uL, 3062009004852183467uL, 16065515842120794365uL, 74184876899443393uL, 16563765655732577159uL, 9131956796466541322uL,
		8604540880985875509uL, 22099178757704754uL, 16690920901523858194uL, 11331521809212514546uL, 2945473010562318822uL, 15182352039751412520uL, 2789803412788518275uL, 13422792374992604543uL, 15567727576646958478uL, 1017933909609308228uL,
		16309966615540910654uL, 8230916861376446652uL, 14396504241698491859uL, 8983610917420146076uL, 8543542228473779244uL, 1721876046845854392uL, 16194459883656067231uL, 5559864569757380000uL, 4937681992884682033uL, 13005489746079912805uL,
		9379902043379058579uL, 5670390740934713304uL, 2219071780988037499uL, 7008521987288882964uL, 6028345117330418825uL, 10946567170512804608uL, 7071075452076274675uL, 16842568984047522312uL, 1445978213955986826uL, 10467709131392737444uL,
		951333080223670799uL, 6099155138413436065uL, 14140843974652577825uL, 12209974622899604911uL, 15533845830470436847uL, 16381003300289283813uL, 14619566180652406020uL, 1340472571717533606uL, 14798380781942060739uL, 12690176289563455943uL,
		4461163794677446508uL, 12598027068668226835uL, 3341940384398866564uL, 13564145691162448073uL, 3829921822543532494uL, 899996630714791418uL, 6478536468284266291uL, 2994597028103565543uL, 6124895672834828926uL, 10070201468809780037uL,
		14034091836647305274uL, 10722043131897179970uL, 728866099714851926uL, 339635816873858970uL, 17293171257415384160uL, 17854528813163386564uL, 11296654129530459363uL, 8700134485486622004uL, 12894110748725224554uL, 17148226315594415145uL,
		8749621007278605595uL, 12313167596287644540uL, 4199955888901663150uL, 13105311278491538903uL, 18206853885491773239uL, 8106773277103211697uL, 16217424015630281360uL, 5930619164422717276uL, 4368075505682949467uL, 4623369983466747106uL,
		8403817438537116875uL, 13118988004869881546uL, 1151085119119418028uL, 6933250016240323664uL, 6814675599201764477uL, 15451253908724655102uL, 5778917359701360712uL, 11112271228158943598uL, 9234396265040989002uL, 10660000026621187831uL,
		4025584697920591189uL, 5446500518121291045uL, 10580078819325063104uL, 18093856480622414774uL, 8290028954029701554uL, 9359194341002304104uL, 7234639242841923679uL, 2860911103167493259uL, 14729974056387769779uL, 7444204691177324181uL,
		8012224255291120002uL, 6549509778060988165uL, 13790479014885986647uL, 16914047268224035561uL, 4993489137437819341uL, 4727924503904151836uL, 15266142735205863280uL, 7858325008468642462uL, 6561287832113134677uL, 1893413629145602549uL,
		12241423297023873018uL, 7334764389497132503uL, 421942495471316930uL, 9361514122259283269uL, 5948965432456907277uL, 11573866571256030207uL, 4831763938021002582uL, 14173855499281032303uL, 5678704711006605406uL, 4536654317168965104uL,
		802439540090739142uL, 1728614842704535657uL, 7852250862810361152uL, 15476660523196402343uL, 6999787169451700297uL, 327545298748531618uL, 15682530895364148274uL, 9213801181845131435uL, 12496725194737746507uL, 16259867463176200084uL,
		15345880568547961059uL, 18251822138640095379uL, 2629011484744925146uL, 679658461659738748uL, 15377935326821115525uL, 2845612796809381245uL, 10724645847535636471uL, 7273530125705028225uL, 4410076014410041819uL, 16142531744609233649uL,
		18400807702465453034uL, 12734021026892126223uL, 8922873767131958175uL, 15064444873285696908uL, 15209927617758412081uL, 14409996395411159111uL, 5226125132195873799uL, 2940247444995640068uL, 14028725908667580799uL, 6671397049608501367uL,
		8821388386505911040uL, 14866556336909964964uL, 16999697712800573186uL, 2147098610462912262uL, 16490478192134913802uL, 15589826239460328034uL, 5141735866072457044uL, 3265027362719053310uL, 11995823427747035680uL, 6017965846669640613uL,
		4287051124723328232uL, 8655371236021312991uL, 17289896101590403443uL, 2365060307249772354uL, 1630631832073154105uL, 1828719980936758421uL, 2674037562503248056uL, 11151127292458434926uL, 17083602979237295729uL, 204405347605452144uL,
		5797523068258732423uL, 8122903338174012641uL, 8739821670855295734uL, 961841682317282412uL, 3487881148722869326uL, 10451359914320687899uL, 7665614591556333409uL, 10615335048481936743uL, 17623836910915152341uL, 16755608983150617741uL,
		3797048810173566205uL, 15867839772959253853uL, 15036032900410842080uL, 577633178325057199uL, 11067531136919120693uL, 9410969925345319376uL, 2754939666238358593uL, 8444132705799138470uL, 10552522441266611941uL, 3065464070595795438uL,
		11836294715923403837uL, 3184382822055416328uL, 5740274767717360273uL, 6179930651821454089uL, 13620591815564702195uL, 5115645765347262247uL, 4602739923119569497uL, 14980942922478280335uL, 12087144524938010904uL, 16520591415739429341uL,
		9977754778323748670uL, 11946163567554916583uL, 4125629484990072616uL, 11612073089940694572uL, 13601564719816443589uL, 4230689665262407186uL, 16597059646647655223uL, 9047540561879224854uL, 1112218670439199625uL, 8426162753992594376uL,
		12455974392228691485uL, 15942953649737145623uL, 4028912247909671416uL, 18037587660758276778uL, 10068912122063836921uL, 17294173404640996964uL, 12119325820894234776uL, 14721184867647846348uL, 1964465731879646024uL, 16004983352460288019uL,
		6946242362685775318uL, 15147764321093464775uL, 11210460518370038227uL, 17027551023089054838uL, 18353008346233291053uL, 12541344992679135386uL, 2507248404937789251uL, 7581261321693772141uL, 9610178040610218018uL, 520172056875071564uL,
		3738403388662150470uL, 16089237235933099576uL, 13444004222476132682uL, 930169001927683533uL, 6889748805645999668uL, 17415394646893863865uL, 7941113837267854943uL, 17203533056638157852uL, 16292115423603831981uL, 6332043450707792835uL,
		3386824618901547762uL, 7130458179308482168uL, 1271522336860346025uL, 17449709749372114003uL, 4823850509807911142uL, 3107332511049695348uL, 5437793788182680416uL, 10131116070914134461uL, 1494290439970088554uL, 9837305513065677719uL,
		10238790748255110929uL, 13014122770789771601uL, 1159256241058966379uL, 1026141471931805870uL, 10231135287654865684uL, 17837053010959982172uL, 7511556330643118785uL, 14530951735809871833uL, 3932170512244996561uL, 6834333685245251200uL,
		4355290964656419152uL, 6487547078612259600uL, 6267880520331323438uL, 16901268206404951963uL, 8190919284549556346uL, 3366895789332200348uL, 2444540809879438627uL, 6459524513146455969uL, 4077716903750958194uL, 12277814504276850140uL,
		11473260408293916814uL, 13249302657669755564uL, 7734160491610189202uL, 7910254887717195099uL, 3836881802794822270uL, 8311228008842563790uL, 730509642500215940uL, 17796343913904606621uL, 13322520308326068757uL, 3579688877020158541uL,
		8591780283260295173uL, 5028082178778891827uL, 17947929312755564086uL, 15737034618683411560uL, 5487541034902828271uL, 8530400576707172340uL, 10842208886204497163uL, 17577087322588800898uL, 4656569414526204412uL, 491061932033469878uL,
		8035458231926703496uL, 137019260109594401uL, 7421708309958176805uL, 8223709417363553275uL, 5401705824239018731uL, 11284135823146617054uL, 5308870500428712900uL, 12937794336414209978uL, 1376856236535589493uL, 12790835156597546584uL,
		11346069089450335244uL, 1332977380922036690uL, 3015788518022419172uL, 11727889587379563708uL, 6396540069380292132uL, 2034188120276215631uL, 16791609835598348582uL, 17937002894199062475uL, 3623665942510192329uL, 9281808803060841315uL,
		1765784450088366494uL, 5837777785993897047uL, 1564973338399864744uL, 15841348874649115855uL, 4964475598524693274uL, 13134700095219650201uL, 6706291041494563888uL, 17656797450059587882uL, 10355440293737830067uL, 7456716478970921562uL,
		18111480716034354357uL, 9931395181607471617uL, 11397947510903519547uL, 18213715995450361897uL, 284725780453796946uL, 14614670887385324978uL, 13525508979215740547uL, 13357650568845892272uL, 12839204429038201151uL, 9535062457613112024uL,
		13702844559136150558uL, 10782422547259353446uL, 13847462387142919467uL, 2560491659082246267uL, 8971180328015050686uL, 2265540171276805379uL, 6093561527083620308uL, 12169565841013306uL, 9128413284208255679uL, 14268022017174275008uL,
		9486595659187961990uL, 14229791298934897290uL, 13071773666531600249uL, 11777955427119840489uL, 15499833483678125794uL, 9771890684304357024uL, 10910763655887102767uL, 12331386150595254155uL, 10380906726741623612uL, 10959706799060127120uL,
		16385370526716955323uL, 12663551718386818228uL, 7153300451507295513uL, 9667256041923175882uL, 2187906506867626476uL, 5612681432830855607uL, 13793523891730566065uL, 4688837593722596333uL, 14631077022245992099uL, 16667000290047189060uL,
		14796252507804280846uL, 13917690577461137509uL, 14425632076328529814uL, 14096329984509715743uL
	};

	/// <summary>
	/// Initializes a new instance of the <see cref="T:TigerHash" /> class.
	/// </summary>
	public TigerHash()
	{
		internalDataBuffer = new byte[64];
		HashSizeValue = 192;
		Initialize();
	}

	/// <summary>
	/// Initializes an instance of <see cref="T:TigerHash" />.
	/// </summary>
	public override void Initialize()
	{
		a = 81985529216486895uL;
		b = 18364758544493064720uL;
		c = 17336226011405279623uL;
		bufferPosition = 0;
		totalLength = 0L;
	}

	/// <summary>Routes data written to the object into the <see cref="T:TigerHash" /> hash algorithm for computing the hash.</summary>
	/// <param name="array">The input data. </param>
	/// <param name="ibStart">The offset into the byte array from which to begin using data. </param>
	/// <param name="cbSize">The number of bytes in the array to use as data. </param>
	protected override void HashCore(byte[] array, int ibStart, int cbSize)
	{
		totalLength += cbSize;
		byte[] buffer = internalDataBuffer;
		int offset = bufferPosition;
		int end = ibStart + cbSize;
		while (ibStart < end)
		{
			int count = 64 - offset;
			if (count > cbSize)
			{
				count = cbSize;
			}
			Buffer.BlockCopy(array, ibStart, buffer, offset, count);
			ibStart += count;
			offset += count;
			cbSize -= count;
			if (64 > offset)
			{
				break;
			}
			ProcessBlock();
			offset = 0;
		}
		bufferPosition = offset;
	}

	/// <summary>
	/// Returns the computed <see cref="T:TigerHash" /> hash value after all data has been written to the object.
	/// </summary>
	/// <returns>The computed hash code.</returns>
	protected override byte[] HashFinal()
	{
		int bufferOffset = bufferPosition;
		byte[] buffer = internalDataBuffer;
		buffer[bufferOffset] = 1;
		bufferOffset++;
		if (56 <= bufferOffset)
		{
			Array.Clear(buffer, bufferOffset, 64 - bufferOffset);
			ProcessBlock();
			bufferOffset = 0;
		}
		Array.Clear(buffer, bufferOffset, 64 - bufferOffset - 8);
		LongToBytes((ulong)(totalLength << 3), buffer, 56);
		ProcessBlock();
		byte[] retval = new byte[24];
		LongToBytes(a, retval, 0);
		LongToBytes(b, retval, 8);
		LongToBytes(c, retval, 16);
		return retval;
	}

	private void ProcessBlock()
	{
		Buffer.BlockCopy(internalDataBuffer, 0, block, 0, 64);
		Compress();
	}

	private void Compress()
	{
		ulong aa = a;
		ulong bb = b;
		ulong cc = c;
		ulong[] tmpBlock = block;
		RoundABC(tmpBlock[0], 5u);
		RoundBCA(tmpBlock[1], 5u);
		RoundCAB(tmpBlock[2], 5u);
		RoundABC(tmpBlock[3], 5u);
		RoundBCA(tmpBlock[4], 5u);
		RoundCAB(tmpBlock[5], 5u);
		RoundABC(tmpBlock[6], 5u);
		RoundBCA(tmpBlock[7], 5u);
		Schedule(tmpBlock);
		RoundCAB(tmpBlock[0], 7u);
		RoundABC(tmpBlock[1], 7u);
		RoundBCA(tmpBlock[2], 7u);
		RoundCAB(tmpBlock[3], 7u);
		RoundABC(tmpBlock[4], 7u);
		RoundBCA(tmpBlock[5], 7u);
		RoundCAB(tmpBlock[6], 7u);
		RoundABC(tmpBlock[7], 7u);
		Schedule(tmpBlock);
		RoundBCA(tmpBlock[0], 9u);
		RoundCAB(tmpBlock[1], 9u);
		RoundABC(tmpBlock[2], 9u);
		RoundBCA(tmpBlock[3], 9u);
		RoundCAB(tmpBlock[4], 9u);
		RoundABC(tmpBlock[5], 9u);
		RoundBCA(tmpBlock[6], 9u);
		RoundCAB(tmpBlock[7], 9u);
		a ^= aa;
		b -= bb;
		c += cc;
	}

	private static void Schedule(ulong[] x)
	{
		x[0] -= x[7] ^ 0xA5A5A5A5A5A5A5A5uL;
		x[1] ^= x[0];
		x[2] += x[1];
		x[3] -= x[2] ^ (~x[1] << 19);
		x[4] ^= x[3];
		x[5] += x[4];
		x[6] -= x[5] ^ ((~x[4] >> 23) & 0x1FFFFFFFFFFL);
		x[7] ^= x[6];
		x[0] += x[7];
		x[1] -= x[0] ^ (~x[7] << 19);
		x[2] ^= x[1];
		x[3] += x[2];
		x[4] -= x[3] ^ ((~x[2] >> 23) & 0x1FFFFFFFFFFL);
		x[5] ^= x[4];
		x[6] += x[5];
		x[7] -= x[6] ^ 0x123456789ABCDEFL;
	}

	private void RoundABC(ulong x, uint mul)
	{
		ulong[] T = TigerHash.T;
		ulong tmpC = c ^ x;
		int ch = (int)(tmpC >> 32);
		int cl = (int)tmpC;
		a -= T[cl & 0xFF] ^ T[((cl >> 16) & 0xFF) + 256] ^ T[(ch & 0xFF) + 512] ^ T[((ch >> 16) & 0xFF) + 768];
		b += T[((cl >> 8) & 0xFF) + 768] ^ T[((cl >> 24) & 0xFF) + 512] ^ T[((ch >> 8) & 0xFF) + 256] ^ T[(ch >> 24) & 0xFF];
		b *= mul;
		c = tmpC;
	}

	private void RoundBCA(ulong x, uint mul)
	{
		ulong[] T = TigerHash.T;
		ulong tmpA = a ^ x;
		int ah = (int)(tmpA >> 32);
		int al = (int)tmpA;
		b -= T[al & 0xFF] ^ T[((al >> 16) & 0xFF) + 256] ^ T[(ah & 0xFF) + 512] ^ T[((ah >> 16) & 0xFF) + 768];
		c += T[((al >> 8) & 0xFF) + 768] ^ T[((al >> 24) & 0xFF) + 512] ^ T[((ah >> 8) & 0xFF) + 256] ^ T[(ah >> 24) & 0xFF];
		c *= mul;
		a = tmpA;
	}

	private void RoundCAB(ulong x, uint mul)
	{
		ulong[] T = TigerHash.T;
		ulong tmpB = b ^ x;
		int bh = (int)(tmpB >> 32);
		int bl = (int)tmpB;
		c -= T[bl & 0xFF] ^ T[((bl >> 16) & 0xFF) + 256] ^ T[(bh & 0xFF) + 512] ^ T[((bh >> 16) & 0xFF) + 768];
		a += T[((bl >> 8) & 0xFF) + 768] ^ T[((bl >> 24) & 0xFF) + 512] ^ T[((bh >> 8) & 0xFF) + 256] ^ T[(bh >> 24) & 0xFF];
		a *= mul;
		b = tmpB;
	}

	private unsafe static void LongToBytes(ulong value, byte[] buffer, int offset)
	{
		fixed (byte* numRef = buffer)
		{
			*(ulong*)(numRef + offset) = value;
		}
	}
}
