using System;
using System.Collections;
using Aspose.Words;
using Aspose.Words.Drawing;
using x13f1efc79617a47b;
using x6c95d9cf46ff5f25;
using xfbd1009a0cbb9842;

namespace x4adf554d20d941a6;

internal class xa268fdb9ca040dde
{
	private readonly x99571aae8ed1b907 x7a2344079d102d27 = new x99571aae8ed1b907();

	private x4e2f8bff72d83f71 xe1b1f1bb8f4debec;

	private Hashtable xb89e872cac26381b;

	private Hashtable xc72ddcbcaca479e2 = new Hashtable();

	internal x99571aae8ed1b907 x99571aae8ed1b907 => x7a2344079d102d27;

	internal x4e2f8bff72d83f71 x4e2f8bff72d83f71
	{
		get
		{
			if (xe1b1f1bb8f4debec == null)
			{
				xe1b1f1bb8f4debec = new x4e2f8bff72d83f71(this);
			}
			return xe1b1f1bb8f4debec;
		}
	}

	private bool xdc403e09d5e4130e => xb89e872cac26381b != null;

	internal void xef23aa45e7612fdd(x5015a0e79fc04a51 x13d4cb8d1bd20347, x56410a8dd70087c5 x5906905c888d3d98)
	{
		xac6c82c74ce247fb xac6c82c74ce247fb2 = x13d4cb8d1bd20347.xac6c82c74ce247fb;
		if (xac6c82c74ce247fb2 == null)
		{
			xac6c82c74ce247fb2 = (x13d4cb8d1bd20347.xac6c82c74ce247fb = x35660b2c6a07f849(x13d4cb8d1bd20347));
		}
		xef23aa45e7612fdd(xac6c82c74ce247fb2, x13d4cb8d1bd20347.x3e8d56eefc6dfdad, x5906905c888d3d98);
	}

	internal void xef23aa45e7612fdd(xac6c82c74ce247fb x93d8434f027afd5a, x56410a8dd70087c5 xd9ff4dee1dba180e, x56410a8dd70087c5 x5906905c888d3d98)
	{
		x3c81b884cf5d3405 x3c81b884cf5d3406 = xf8fd10884fbd19ff(x93d8434f027afd5a);
		x3c81b884cf5d3406.xef23aa45e7612fdd(xd9ff4dee1dba180e, x5906905c888d3d98);
		if (x5906905c888d3d98 is x5c28fdcd27dee7d9 && x5906905c888d3d98.x6e414db5d060a816 == x6e414db5d060a816.x12cb12b5d2cad53d && !x0ea55a01b497891d(x5906905c888d3d98))
		{
			x4e2f8bff72d83f71.x84aa3570d857bec4[((x5c28fdcd27dee7d9)x5906905c888d3d98).xb7c4cf9f30ad5f2a] = x5906905c888d3d98;
		}
		if (x5906905c888d3d98.x5566e2d2acbd1fbe == 25604)
		{
			xa67197c42bddc7dc xa67197c42bddc7dc2 = (xa67197c42bddc7dc)x5906905c888d3d98;
			if (xa67197c42bddc7dc2.x40212106aad8a8b0 is Shape)
			{
				xc72ddcbcaca479e2.Add(x5906905c888d3d98, x5906905c888d3d98);
			}
		}
	}

	internal void x52b190e626f65140(x56410a8dd70087c5 x5906905c888d3d98)
	{
		x3c81b884cf5d3405 x3c81b884cf5d3406 = xf8fd10884fbd19ff(x5906905c888d3d98.x53111d6596d16a99);
		if (x5906905c888d3d98 is x5c28fdcd27dee7d9 && x5906905c888d3d98.x6e414db5d060a816 == x6e414db5d060a816.x12cb12b5d2cad53d)
		{
			x4e2f8bff72d83f71.x84aa3570d857bec4.Remove(((x5c28fdcd27dee7d9)x5906905c888d3d98).xb7c4cf9f30ad5f2a);
		}
		if (x5906905c888d3d98 is xa67197c42bddc7dc)
		{
			ArrayList arrayList = xadc3894cf4d45923((xa67197c42bddc7dc)x5906905c888d3d98);
			for (int i = 0; i < arrayList.Count; i++)
			{
				x4e2f8bff72d83f71.x84aa3570d857bec4.Remove(arrayList[i]);
			}
			if (x5906905c888d3d98.x00fa20d37841acd0)
			{
				x69b514a957929a68(x5906905c888d3d98);
			}
		}
		if (x5906905c888d3d98.x53111d6596d16a99.xf684fc5abe7ca67a && x5906905c888d3d98.x00fa20d37841acd0)
		{
			if (x5906905c888d3d98 is x92361dccfa0347fd || x5906905c888d3d98 is xfb0c927634a887df)
			{
				x6a4240fd6fb00a17(x5906905c888d3d98.x4397a67a49a78a04);
			}
			else if (x5906905c888d3d98 is x41ac54db4e627dea && x5566e2d2acbd1fbe.x74f5d3c8c1c169b6(x5906905c888d3d98.x5566e2d2acbd1fbe))
			{
				xd75122f2b64f9e90((xf6689e0eed33812c)x5906905c888d3d98.x406d8cd2af514771.x2cbc0fc707d2e1eb());
			}
		}
		if (xc72ddcbcaca479e2.ContainsKey(x5906905c888d3d98))
		{
			xc72ddcbcaca479e2.Remove(x5906905c888d3d98);
		}
		x3c81b884cf5d3406.x52b190e626f65140(x5906905c888d3d98);
	}

	private static void x69b514a957929a68(x56410a8dd70087c5 x5906905c888d3d98)
	{
		xd4c1d21f07094800 xd4c1d21f7094801 = null;
		switch (xa7a98231d4a67a0f.xe7480f4a43f6f00f(x5906905c888d3d98))
		{
		case xae532cfb203d8406.x11db8fc7f469a2fc:
		{
			x86accec882b7012a x86accec882b7012a2 = (x86accec882b7012a)x5906905c888d3d98.xce4443deee105995(x954503abc583f675.x11db8fc7f469a2fc);
			if (x86accec882b7012a2 != null)
			{
				xd4c1d21f7094801 = x86accec882b7012a2.xf9d5944b191eb276(x5aa7d09b258e0f23: false);
			}
			break;
		}
		case xae532cfb203d8406.x53111d6596d16a99:
		{
			xc7f90d9c7c51cede xc7f90d9c7c51cede2 = x5906905c888d3d98.x776fd7c2f7270172();
			if (xc7f90d9c7c51cede2 != null)
			{
				xd4c1d21f7094801 = xc7f90d9c7c51cede2.xf9d5944b191eb276(x5aa7d09b258e0f23: false);
			}
			break;
		}
		}
		xd4c1d21f7094801?.xde11bc5d740d3ee3(x5906905c888d3d98, x42cfb54f69c550b9: true);
	}

	private static ArrayList xadc3894cf4d45923(xa67197c42bddc7dc x5906905c888d3d98)
	{
		x3ee7f5c70fde3f94 x3ee7f5c70fde3f95 = x5906905c888d3d98.x0cdfd951d792f320(x5aa7d09b258e0f23: false);
		ArrayList arrayList = new ArrayList();
		if (x3ee7f5c70fde3f95 != null)
		{
			ArrayList arrayList2 = x4e2f8bff72d83f71.xd098fecd461cd28c(x3ee7f5c70fde3f95);
			for (int i = 0; i < arrayList2.Count; i++)
			{
				ArrayList arrayList3 = (ArrayList)arrayList2[i];
				for (int j = 0; j < arrayList3.Count; j++)
				{
					x5c28fdcd27dee7d9 x5c28fdcd27dee7d10 = (x5c28fdcd27dee7d9)arrayList3[j];
					if (x5c29822913be33c1.x6caf38183f332e86(x5c28fdcd27dee7d10.xc96d173d58dd8a20))
					{
						arrayList.Add(x5c28fdcd27dee7d10.xb7c4cf9f30ad5f2a);
					}
				}
			}
		}
		return arrayList;
	}

	private static bool x0ea55a01b497891d(x56410a8dd70087c5 x5906905c888d3d98)
	{
		xac6c82c74ce247fb x53111d6596d16a = x5906905c888d3d98.x53111d6596d16a99;
		while (x53111d6596d16a is x3ee7f5c70fde3f94)
		{
			x53111d6596d16a = ((x3ee7f5c70fde3f94)x53111d6596d16a).x1452024de1251c74.x53111d6596d16a99;
		}
		return x53111d6596d16a is xb1f375aa1b12d10f;
	}

	internal void x408f4b7efc86fd49()
	{
		if (!xdc403e09d5e4130e)
		{
			return;
		}
		x3c81b884cf5d3405 x3c81b884cf5d3406 = (x3c81b884cf5d3405)xb89e872cac26381b[x4e2f8bff72d83f71.x80f061859cd048ae];
		x3c81b884cf5d3406?.x408f4b7efc86fd49();
		foreach (x3c81b884cf5d3405 value in xb89e872cac26381b.Values)
		{
			if (value != null && x3c81b884cf5d3406 != value)
			{
				value.x408f4b7efc86fd49();
			}
		}
		x88281f3708937db2();
		xb89e872cac26381b = null;
	}

	private void x88281f3708937db2()
	{
		Hashtable hashtable = new Hashtable();
		foreach (xa67197c42bddc7dc key in xc72ddcbcaca479e2.Keys)
		{
			Shape shape = (Shape)key.x40212106aad8a8b0;
			int xea1e81378298fa = shape.xea1e81378298fa81;
			if (hashtable[xea1e81378298fa] is int)
			{
				xa67197c42bddc7dc xa67197c42bddc7dc3 = (xa67197c42bddc7dc)hashtable[(int)hashtable[xea1e81378298fa]];
				xa67197c42bddc7dc3.x92adfed6f1d8efe4 = key;
				key.xd8cde6b694c3af46 = xa67197c42bddc7dc3;
			}
			if (!(hashtable[xea1e81378298fa] is x56410a8dd70087c5))
			{
				hashtable[xea1e81378298fa] = key;
			}
			if (hashtable.ContainsKey(shape.xdf3d5f8941ea27a6))
			{
				xa67197c42bddc7dc xa67197c42bddc7dc4 = (xa67197c42bddc7dc)hashtable[shape.xdf3d5f8941ea27a6];
				xa67197c42bddc7dc4.xd8cde6b694c3af46 = key;
				key.x92adfed6f1d8efe4 = xa67197c42bddc7dc4;
			}
			else if (shape.xdf3d5f8941ea27a6 != 0)
			{
				hashtable[shape.xdf3d5f8941ea27a6] = xea1e81378298fa;
			}
		}
	}

	internal void xc3819e13f60dd8e6(bool xfad304b5f8f3bb5b)
	{
		x408f4b7efc86fd49();
		x4e2f8bff72d83f71.x80f061859cd048ae.xc3819e13f60dd8e6(xfad304b5f8f3bb5b);
		xae79613d86677304(StoryType.Footnotes);
		xae79613d86677304(StoryType.Endnotes);
		xae79613d86677304(StoryType.Comments);
	}

	internal void x51b09bddd13a48d7(int x4ae3aef7c573c0c7)
	{
		x7a2344079d102d27.x1914eddf1fde1228(x4ae3aef7c573c0c7);
	}

	internal void x16d239165f7f2b5e()
	{
		x7a2344079d102d27.x47c79a4d207183de();
	}

	private void xae79613d86677304(StoryType xdbbf47b5e620c262)
	{
		xac6c82c74ce247fb xac6c82c74ce247fb2 = x4e2f8bff72d83f71.xe5cdc2a3cec80364(xdbbf47b5e620c262, x5aa7d09b258e0f23: false);
		if (xac6c82c74ce247fb2 != null)
		{
			xac6c82c74ce247fb2.xe5764fe5359a6d91 = true;
		}
	}

	private xac6c82c74ce247fb x35660b2c6a07f849(x5015a0e79fc04a51 x13d4cb8d1bd20347)
	{
		if (x13d4cb8d1bd20347.x3e8d56eefc6dfdad != null && x13d4cb8d1bd20347.x3e8d56eefc6dfdad.x53111d6596d16a99 != null)
		{
			return x13d4cb8d1bd20347.x3e8d56eefc6dfdad.x53111d6596d16a99;
		}
		switch (x13d4cb8d1bd20347.xfe6cdb7c00822bd9)
		{
		case StoryType.MainText:
			return x4e2f8bff72d83f71.x80f061859cd048ae;
		case StoryType.Comments:
			return x4e2f8bff72d83f71.xe6f13b2cfaddaa67;
		case StoryType.Footnotes:
			return x4e2f8bff72d83f71.x31b433cb13e4aa24;
		case StoryType.Endnotes:
			return x4e2f8bff72d83f71.xe427d253f517c8ee;
		case StoryType.Textbox:
			x0d299f323d241756.x0aaaea7864a53f26(x13d4cb8d1bd20347.xc9476e3b4aa0e174, "position");
			return x13d4cb8d1bd20347.xc9476e3b4aa0e174.x0cdfd951d792f320(x5aa7d09b258e0f23: true);
		case StoryType.EvenPagesHeader:
		case StoryType.PrimaryHeader:
		case StoryType.EvenPagesFooter:
		case StoryType.PrimaryFooter:
		case StoryType.FirstPageHeader:
		case StoryType.FirstPageFooter:
			x0d299f323d241756.x0aaaea7864a53f26(x13d4cb8d1bd20347.xc9476e3b4aa0e174, "position");
			return x13d4cb8d1bd20347.xc9476e3b4aa0e174.x2c0c9a4fb5b11521.xf2752069362a145a(x4e2f8bff72d83f71, x13d4cb8d1bd20347.xfe6cdb7c00822bd9, x5aa7d09b258e0f23: true);
		case StoryType.FootnoteSeparator:
		case StoryType.FootnoteContinuationSeparator:
		case StoryType.EndnoteSeparator:
		case StoryType.EndnoteContinuationSeparator:
			return x4e2f8bff72d83f71.xd410c9b07f3bc70b.get_xe6d4b1b411ed94b5(x13d4cb8d1bd20347.xfe6cdb7c00822bd9);
		default:
			throw new InvalidOperationException("Unexpected story type.");
		}
	}

	private x3c81b884cf5d3405 xf8fd10884fbd19ff(xac6c82c74ce247fb x2612f62f94df47de)
	{
		if (xb89e872cac26381b == null)
		{
			xb89e872cac26381b = new Hashtable();
		}
		x3c81b884cf5d3405 x3c81b884cf5d3406 = (x3c81b884cf5d3405)xb89e872cac26381b[x2612f62f94df47de];
		if (x3c81b884cf5d3406 == null)
		{
			x3c81b884cf5d3406 = new x3c81b884cf5d3405(x2612f62f94df47de);
			xb89e872cac26381b.Add(x2612f62f94df47de, x3c81b884cf5d3406);
		}
		return x3c81b884cf5d3406;
	}

	private static void x6a4240fd6fb00a17(xe0e644109215bf44 xb32f8dd719a105db)
	{
		xf3f447691ab38eee xf3f447691ab38eee2 = xb32f8dd719a105db.x876bae1be4c51fa1.xb3a79d506b0e2f7f.x8b61531c8ea35b85();
		if (!xf3f447691ab38eee2.xd8b11076ff837685(((x8d9303345f12a846)xb32f8dd719a105db.x88fee64dba8223f9).x2be2727bb322530e))
		{
			throw new InvalidOperationException(string.Intern(x1110bdd110cdcea4._xaacba899487bce8c("oancjcedddldadceocjeadafjngfdcofccfggcmgcbdhinjh", 18361547)));
		}
		ArrayList arrayList = new ArrayList();
		do
		{
			arrayList.Add(xf3f447691ab38eee2.x35cfcea4890f4e7d);
		}
		while (xf3f447691ab38eee2.x355eaee82ffc1f46() && !x5566e2d2acbd1fbe.xd707791130626739(((x56410a8dd70087c5)xf3f447691ab38eee2.x35cfcea4890f4e7d).x5566e2d2acbd1fbe));
		x3c81b884cf5d3405 x3c81b884cf5d3406 = new x3c81b884cf5d3405(xb32f8dd719a105db.x876bae1be4c51fa1);
		for (int num = arrayList.Count - 1; num >= 0; num--)
		{
			x3c81b884cf5d3406.x52b190e626f65140((x56410a8dd70087c5)arrayList[num]);
		}
	}

	private static void xd75122f2b64f9e90(xf6689e0eed33812c xb32f8dd719a105db)
	{
		for (xc7f90d9c7c51cede xc7f90d9c7c51cede2 = xb32f8dd719a105db.x86a0dde4c22f516b; xc7f90d9c7c51cede2 != null; xc7f90d9c7c51cede2 = xc7f90d9c7c51cede2.x3d695937fd09df4b)
		{
			if (xc7f90d9c7c51cede2.x3c1c340351d94fbd == xb32f8dd719a105db)
			{
				xc7f90d9c7c51cede2.x1ea60bde2b5d0d28 = null;
				xc7f90d9c7c51cede2.x1d7b771e95a9abb5 = null;
			}
			else if (xc7f90d9c7c51cede2.x3c1c340351d94fbd == xb32f8dd719a105db.x0d6e7e3547c7244f)
			{
				break;
			}
		}
	}
}
